(self.webpackChunkgerstner_waves_rf3=self.webpackChunkgerstner_waves_rf3||[]).push([[210],{4482:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});t(2791);var r,i=t(168),o=t(5751),a=t(9020),s=t(1758),c=o.ZP.div(r||(r=(0,i.Z)(["\n  height: calc(100vh - ",");\n  background-color: ",";\n\n  overflow: hidden;\n"])),a.Z.header,s.Z.bg),l=t(184),u=function(e){var n=e.children;return(0,l.jsx)(c,{children:n})}},3179:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});t(2791);var r,i=t(3285),o=t(3520),a=t(184),s=t(168),c=t(5751).ZP.div(r||(r=(0,s.Z)(["\n  width: 100%;\n  height: 100%;\n\n  background-color: #f5f5f5;\n"]))),l=function(e){var n=e.children;return(0,a.jsx)(c,{children:(0,a.jsxs)(i.Xz,{camera:{position:[75,25,25]},children:[(0,a.jsx)(o.z,{minDistance:15,maxDistance:150,maxPolarAngle:Math.PI/2.5}),n,null]})})}},8162:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(2791),i=t(4671),o=t(184),a=function(){return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(i.q,{distance:45e4,sunPosition:[1e3,1e3,8e3],inclination:10,turbidity:.5})})},s=(0,r.memo)(a)},3077:function(e,n,t){"use strict";t.d(n,{Z:function(){return f}});var r=t(2791),i=t(1413),o=t(4925),a=t(4128),s=t(3285),c=t(184),l=["model"],u=(0,r.forwardRef)((function(e,n){var r=e.model,u=(0,o.Z)(e,l),v=(0,s.U2)(a.y,t(9627)("./".concat(r)));return(0,c.jsx)("primitive",(0,i.Z)({ref:n,object:v},u))})),v=(0,r.memo)(u),f=function(e){var n=e.getWaveInfo,t=r.useRef(),i=r.useRef();return(0,s.xQ)((function(e){var r=e.clock,o=n(0,0,r.getElapsedTime()),a=n(0,256,r.getElapsedTime());null!==t&&void 0!==t&&t.current&&null!==i&&void 0!==i&&i.current&&(i.current.position.set(1.15*-a.x,a.y,256),t.current.position.set(o.x,o.y+7,o.z),t.current.lookAt(i.current.position))})),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("mesh",{ref:i,children:[(0,c.jsx)("planeBufferGeometry",{args:[256,256]}),(0,c.jsx)("meshStandardMaterial",{opacity:0,transparent:!0})]}),(0,c.jsx)(v,{ref:t,model:"ship.fbx",scale:[.5,.5,.5]})]})}},621:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(1413),i=t(2791),o=t(7760),a=t(3285),s=t(1190),c=t(184);(0,a.l7)({Water:s.B});var l=function(e){var n=e.wireframe,s=e.size,l=e.waveA,u=e.waveB,v=e.waveC,f=(0,i.useRef)(),m=(0,a.Ky)((function(e){return e.gl})),d=(0,a.U2)(o.TextureLoader,t(2410));d.wrapS=d.wrapT=o.RepeatWrapping;var p=(0,i.useCallback)((function(e){e.uniforms.waveA={value:[Math.sin(l.direction*Math.PI/180),Math.cos(l.direction*Math.PI/180),l.steepness,l.wavelength]},e.uniforms.waveB={value:[Math.sin(u.direction*Math.PI/180),Math.cos(u.direction*Math.PI/180),u.steepness,u.wavelength]},e.uniforms.waveC={value:[Math.sin(v.direction*Math.PI/180),Math.cos(v.direction*Math.PI/180),v.steepness,v.wavelength]},e.vertexShader="\nuniform mat4 textureMatrix;\nuniform float time;\n\nvarying vec4 mirrorCoord;\nvarying vec4 worldPosition;\n\n#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n\nuniform vec4 waveA;\nuniform vec4 waveB;\nuniform vec4 waveC;\n\nvec3 GerstnerWave (vec4 wave, vec3 p) {\n    float steepness = wave.z;\n    float wavelength = wave.w;\n    float k = 2.0 * PI / wavelength;\n    float c = sqrt(9.8 / k);\n    vec2 d = normalize(wave.xy);\n    float f = k * (dot(d, vec2(p.x, p.y)) - c * time);\n    float a = steepness / k;\n\n    return vec3(\n        d.x * (a * cos(f)),\n        d.y * (a * cos(f)),\n        a * sin(f)\n    );\n}\n\nvoid main() {\n    mirrorCoord = modelMatrix * vec4( position, 1.0 );\n    worldPosition = mirrorCoord.xyzw;\n    mirrorCoord = textureMatrix * mirrorCoord;\n\n    vec3 gridPoint = position.xyz;\n    vec3 tangent = vec3(1, 0, 0);\n    vec3 binormal = vec3(0, 0, 1);\n    vec3 p = gridPoint;\n    p += GerstnerWave(waveA, gridPoint);\n    p += GerstnerWave(waveB, gridPoint);\n    p += GerstnerWave(waveC, gridPoint);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( p.x, p.y, p.z, 1.0);\n\n    #include <beginnormal_vertex>\n    #include <defaultnormal_vertex>\n    #include <logdepthbuf_vertex>\n    #include <fog_vertex>\n    #include <shadowmap_vertex>\n}\n",e.fragmentShader="\nuniform sampler2D mirrorSampler;\nuniform float alpha;\nuniform float time;\nuniform float size;\nuniform float distortionScale;\nuniform sampler2D normalSampler;\nuniform vec3 sunColor;\nuniform vec3 sunDirection;\nuniform vec3 eye;\nuniform vec3 waterColor;\n\nvarying vec4 mirrorCoord;\nvarying vec4 worldPosition;\n\nuniform float offsetX;\nuniform float offsetZ;\n\nvec4 getNoise( vec2 uv ) {\n    vec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n    vec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n    vec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n    vec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n    vec4 noise = texture2D( normalSampler, uv0 ) +\n        texture2D( normalSampler, uv1 ) +\n        texture2D( normalSampler, uv2 ) +\n        texture2D( normalSampler, uv3 );\n    return noise * 0.5 - 1.0;\n}\n\nvoid sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n    vec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n    float direction = max( 0.0, dot( eyeDirection, reflection ) );\n    specularColor += pow( direction, shiny ) * sunColor * spec;\n    diffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n}\n\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n    #include <logdepthbuf_fragment>\n\n    vec4 noise = getNoise( (worldPosition.xz) + vec2(offsetX/12.25,offsetZ/12.25) * size );\n    vec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n    vec3 diffuseLight = vec3(0.0);\n    vec3 specularLight = vec3(0.0);\n\n    vec3 worldToEye = eye-worldPosition.xyz;\n    vec3 eyeDirection = normalize( worldToEye );\n    sunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n    float distance = length(worldToEye);\n\n    vec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;\n    vec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );\n\n    float theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n    float rf0 = 0.3;\n    float reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n    vec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n    vec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);\n    vec3 outgoingLight = albedo;\n    gl_FragColor = vec4( outgoingLight, alpha );\n\n    #include <tonemapping_fragment>\n    #include <fog_fragment>\n}\n",e.uniforms.size.value=0}),[l,u,v]),h=(0,i.useMemo)((function(){return new o.PlaneGeometry(s,s,s/4,s/4)}),[s]),x=(0,i.useMemo)((function(){return{textureWidth:256,textureHeight:256,waterNormals:d,sunDirection:new o.Vector3,side:o.DoubleSide,waterColor:"#102E4A",sunColor:"#eb8934",distortionScale:8,fog:void 0,format:m.outputEncoding,onBeforeCompile:p}}),[d,l,u,v]);return(0,i.useEffect)((function(){f.current&&(f.current.material.wireframe=n)}),[s,n,l,u,v]),(0,a.xQ)((function(e){var n=e.clock;if(f.current){var t=f.current.material;t.uniforms.time.value=n.getElapsedTime(),t.onBeforeCompile=p}})),(0,c.jsx)("water",{ref:f,args:[h,(0,r.Z)({},x)],"rotation-x":-Math.PI/2,position:[0,2,0]})}},6210:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return p}});var r=t(2791),i=t(7972),o=t(4482),a=t(3179),s=t(8162),c=t(3077),l=t(621),u=t(7760),v=t(184),f=(0,r.createContext)({waveA:{direction:0,steepness:0,wavelength:100},waveB:{direction:0,steepness:0,wavelength:100},waveC:{direction:0,steepness:0,wavelength:100},getWaveInfo:function(e,n,t){return new u.Vector3}}),m=function(e){var n=e.children,t=(0,i.M4)("Wave A",{direction:{label:"Direction",value:0,step:1,min:0,max:359},steepness:{label:"Steepness",value:.15,step:.01,min:0,max:1},wavelength:{label:"Wave Length",value:100,step:1,min:1,max:100}}),r=(0,i.M4)("Wave B",{direction:{label:"Direction",value:30,step:1,min:0,max:359},steepness:{label:"Steepness",value:.15,step:.01,min:0,max:1},wavelength:{label:"Wave Length",value:50,step:1,min:1,max:100}}),o=(0,i.M4)("Wave C",{direction:{label:"Direction",value:60,step:1,min:0,max:359},steepness:{label:"Steepness",value:.15,step:.01,min:0,max:1},wavelength:{label:"Wave Length",value:25,step:1,min:1,max:100}});return(0,v.jsx)(f.Provider,{value:{waveA:t,waveB:r,waveC:o,getWaveInfo:function(e,n,i){var a=new u.Vector3,s=new u.Vector3(1,0,0),c=new u.Vector3(0,0,1);return[t,r,o].forEach((function(t){var r=2*Math.PI/t.wavelength,o=Math.sqrt(9.8/r),l=new u.Vector2(Math.sin(t.direction*Math.PI/180),-Math.cos(t.direction*Math.PI/180)),v=r*(l.dot(new u.Vector2(e,n))-o*i),f=t.steepness/r;a.x+=l.x*(f*Math.cos(v)),a.y+=f*Math.sin(v),a.z+=l.y*(f*Math.cos(v)),s.x+=-l.x*l.x*(t.steepness*Math.sin(v)),s.y+=l.x*(t.steepness*Math.cos(v)),s.z+=-l.x*l.y*(t.steepness*Math.sin(v)),c.x+=-l.x*l.y*(t.steepness*Math.sin(v)),c.y+=l.y*(t.steepness*Math.cos(v)),c.z+=-l.y*l.y*(t.steepness*Math.sin(v))})),a}},children:n})},d=function(){var e=(0,i.M4)("Water",{size:{label:"Water Area",value:512,min:64,max:1024,step:1},wireframe:{label:"Wireframe",value:!1}}),n=e.wireframe,t=e.size,u=(0,r.useContext)(f),m=u.waveA,d=u.waveB,p=u.waveC,h=u.getWaveInfo;return(0,v.jsx)(o.Z,{children:(0,v.jsxs)(a.Z,{children:[(0,v.jsx)("ambientLight",{intensity:.15,position:[100,100,100]}),(0,v.jsx)("pointLight",{position:[100,100,100],intensity:.5}),(0,v.jsx)(s.Z,{}),(0,v.jsx)(c.Z,{getWaveInfo:h}),(0,v.jsx)(l.Z,{waveA:m,waveB:d,waveC:p,wireframe:n,size:t})]})})},p=function(){return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(m,{children:(0,v.jsx)(d,{})})})}},9627:function(e,n,t){var r={"./ship.fbx":2695};function i(e){var n=o(e);return t(n)}function o(e){if(!t.o(r,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=9627},2695:function(e,n,t){"use strict";e.exports=t.p+"static/media/ship.679585528f34ff916505.fbx"},2410:function(e,n,t){"use strict";e.exports=t.p+"static/media/waternormals.537ec85b965d414829ab.jpg"}}]);
//# sourceMappingURL=210.4476bf06.chunk.js.map